<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1241px" height="1353px" viewBox="-0.5 -0.5 1241 1353" content="&lt;mxfile modified=&quot;2019-09-16T13:34:51.963Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot; etag=&quot;BGdgFkm5tnfFGGs-kmwh&quot; pages=&quot;1&quot; version=&quot;11.2.8&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;13e1069c-82ec-6db2-03f1-153e76fe0fe0&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="730" y="477" width="510" height="875" rx="76.5" ry="76.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="240" y="437" width="220" height="395" rx="33" ry="33" fill="#ffffff" stroke="#000000" pointer-events="none"/><ellipse cx="341" cy="60" rx="10" ry="10" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 341 160 L 341 455.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 460.88 L 337.5 453.88 L 341 455.63 L 344.5 453.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="276" y="110" width="130" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(277.5,115.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="127" height="38" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 127px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Set timer <b>compare</b> value at HWP, SF to <b>true</b></div></div></foreignObject><text x="64" y="25" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 341 70 L 341 103.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 108.88 L 337.5 101.88 L 341 103.63 L 344.5 101.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 612 L 341 650.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 655.88 L 337.5 648.88 L 341 650.63 L 344.5 648.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="281" y="552" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(282.5,556.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Get elapsed tick count from the timer (should ideally be 0 if synced perfectly)</div></div></foreignObject><text x="59" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 341 702 L 341 725.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 730.88 L 337.5 723.88 L 341 725.63 L 344.5 723.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="281" y="657" width="120" height="45" rx="6.75" ry="6.75" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(282.5,666.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="25" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Wrap error to within [-HWP/2, +HWP/2]</div></div></foreignObject><text x="59" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Wrap error to within [-HWP/2, +HWP/2]</text></switch></g><g transform="translate(281.5,2.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="113" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>PWM DRIVER ONLY</b></div></div></foreignObject><text x="57" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;PWM DRIVER ONLY&lt;/b&gt;</text></switch></g><path d="M 30 442 L 30 482 Q 30 492 30 502 L 30 572 Q 30 582 40 582 L 274.63 582" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 279.88 582 L 272.88 585.5 L 274.63 582 L 272.88 578.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1.5,414.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="224" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>zeroCrossing interrupt from ADC driver</b></div></div></foreignObject><text x="112" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;b&gt;zeroCrossing interrupt from ADC driver&lt;/b&gt;</text></switch></g><rect x="281" y="462" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(282.5,472.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="38" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">IDLE STATE, wait for ADC zero crossing interrupt</div></div></foreignObject><text x="59" y="25" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">IDLE STATE, wait for ADC zero crossing interrupt</text></switch></g><g transform="translate(81.5,549.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="104" height="25" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Registered callback <br />in the PWM driver</div></div></foreignObject><text x="52" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Registered callback &lt;br&gt;in the PWM driver</text></switch></g><g transform="translate(609.5,32.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="163" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>HWP </b>= Half-wave period <br />of the input (mains) supply<br />in clock ticks (i.e. 10 us in <br />terms of the timer's clock ticks)</div></div></foreignObject><text x="82" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 341 772 L 341 792 L 421 792 L 421 492 L 407.37 492" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 402.12 492 L 409.12 488.5 L 407.37 492 L 409.12 495.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="281" y="732" width="120" height="40" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(295.5,746.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="91" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 92px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Accumulate error</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Accumulate error</text></switch></g><g transform="translate(609.5,114.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="230" height="65" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>SF</b> = Sync frequency flag - if it's true it<br />means the driver is determining the supply<br />frequency, and the PI controller is not used.<br />If false, the frequency is known and the PI<br />controller is used for minor corrections</div></div></foreignObject><text x="115" y="39" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 549 452 L 549 492 Q 549 502 549 512 L 549 617 Q 549 627 559 627 L 799.63 627" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 804.88 627 L 797.88 630.5 L 799.63 627 L 797.88 623.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(491.5,434.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="284" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="font-size: 12px"><b>onZeroCrossingTimeOffset event </b></span><b>from ADC driver</b></div></div></foreignObject><text x="142" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;span style="font-size: 12px"&gt;&lt;b&gt;onZeroCrossingTimeOffset event &lt;/b&gt;&lt;/span&gt;&lt;b&gt;from ADC driver&lt;/b&gt;</text></switch></g><g transform="translate(614.5,594.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="104" height="25" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Registered callback <br />in the PWM driver</div></div></foreignObject><text x="52" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Registered callback &lt;br&gt;in the PWM driver</text></switch></g><rect x="806" y="502" width="120" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(807.5,512.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="38" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">IDLE STATE, wait for ADC zero crossing <b>event</b></div></div></foreignObject><text x="59" y="25" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 341 160 L 341 362 Q 341 372 351 372 L 610 372 Q 620 372 630 372 L 856 372 Q 866 372 866 382 L 866 495.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 866 500.88 L 862.5 493.88 L 866 495.63 L 869.5 493.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 868 672 L 869 672 L 869 695.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 869 700.88 L 865.5 693.88 L 869 695.63 L 872.5 693.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="806" y="582" width="124" height="90" rx="13.5" ry="13.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(807.5,601.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="120" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 120px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Subtract ZCO from the error value recorded during the zero crossing interrupt</div></div></foreignObject><text x="60" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(610.5,219.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="294" height="65" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>ZCO </b>= Zero crossing offset - a value calculated<br /> by the ADC driver equal to the number of ticks<br />elapsed between the time at which the actual zero<br />crossing occurs and the time at which the zero crossing<br />interrupt is raised by the ADC</div></div></foreignObject><text x="147" y="39" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 869 702 L 938 742 L 869 782 L 800 742 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(838.5,736.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="61" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 62px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Is <b>SF true?</b></div></div></foreignObject><text x="31" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Is &lt;b&gt;SF true?&lt;/b&gt;</text></switch></g><path d="M 869 832 L 938 872 L 869 912 L 800 872 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(801.5,859.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="134" height="25" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 134px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Have 7 error values been recorded?</div></div></foreignObject><text x="67" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Have 7 error values been recorded?</text></switch></g><path d="M 800 872 L 770 872 L 770 532 L 799.63 532" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 804.88 532 L 797.88 535.5 L 799.63 532 L 797.88 528.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(776.5,854.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">NO</div></div></foreignObject><text x="9" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NO</text></switch></g><path d="M 869 1052 L 869 1095.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 869 1100.88 L 865.5 1093.88 L 869 1095.63 L 872.5 1093.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="808" y="972" width="122" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(809.5,979.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="65" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Calculate the slope (i.e. increase in error per cycle) using repeated median regression</div></div></foreignObject><text x="59" y="39" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 869 1182 L 869 1202 L 868 1202 L 868 1205.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 868 1210.88 L 864.5 1203.88 L 868 1205.63 L 871.5 1203.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="808" y="1102" width="122" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(809.5,1116.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Adjust the timer <b>compare value </b>based on the calculated slope</div></div></foreignObject><text x="59" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 807 1252 L 770 1252 L 770 532 L 799.63 532" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 804.88 532 L 797.88 535.5 L 799.63 532 L 797.88 528.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="807" y="1212" width="122" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(808.5,1232.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="38" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 118px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Since frequency is now synced, set <b>SF = false</b></div></div></foreignObject><text x="59" y="25" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 869 782 L 869 825.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 869 830.88 L 865.5 823.88 L 869 825.63 L 872.5 823.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(871.5,794.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 869 912 L 869 965.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 869 970.88 L 865.5 963.88 L 869 965.63 L 872.5 963.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(871.5,933.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g><path d="M 401 679.5 L 806 649.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(571.5,669.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="127" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">(error being referenced)</div></div></foreignObject><text x="64" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">(error being referenced)</text></switch></g><path d="M 1081 877 L 1081 900.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1081 905.88 L 1077.5 898.88 L 1081 900.63 L 1084.5 898.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1021" y="807" width="120" height="70" rx="10.5" ry="10.5" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1022.5,816.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Multiply the median error by Kp, accumulated error by Ki</div></div></foreignObject><text x="59" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1081 967 L 1080 967 L 1080 990.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1080 995.88 L 1076.5 988.88 L 1080 990.63 L 1083.5 988.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1021" y="907" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1022.5,911.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Add this calculated value to the timer <b>compare </b>value as a correction</div></div></foreignObject><text x="59" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1080 1057 L 1080 1095.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1080 1100.88 L 1076.5 1093.88 L 1080 1095.63 L 1083.5 1093.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="997" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1021.5,1001.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="51" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Set new timer compare value and reset timer, and enable timer interrupt</div></div></foreignObject><text x="59" y="32" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 938 742 L 1071 742 Q 1081 742 1081 752 L 1081 800.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1081 805.88 L 1077.5 798.88 L 1081 800.63 L 1084.5 798.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(951.5,724.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">NO</div></div></foreignObject><text x="9" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NO</text></switch></g><path d="M 1080 1102 L 1149.5 1142 L 1080 1182 L 1010.5 1142 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1011.5,1129.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="136" height="25" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 135px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Have 100 iterations passed?</div></div></foreignObject><text x="68" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Have 100 iterations passed?</text></switch></g><path d="M 1080 1312 L 1080 1322 L 1200 1322 L 1200 532 L 932.37 532" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 927.12 532 L 934.12 528.5 L 932.37 532 L 934.12 535.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1020" y="1232" width="120" height="80" rx="12" ry="12" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1021.5,1239.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="117" height="65" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 117px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Set <b>SF = true </b>for periodic frequency syncing, set accumulated integral to 0</div></div></foreignObject><text x="59" y="39" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1150 1142 L 1200 1142 L 1200 532 L 932.37 532" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 927.12 532 L 934.12 528.5 L 932.37 532 L 934.12 535.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1171.5,1125.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">NO</div></div></foreignObject><text x="9" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">NO</text></switch></g><path d="M 1080 1182 L 1080 1225.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1080 1230.88 L 1076.5 1223.88 L 1080 1225.63 L 1083.5 1223.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1082.5,1200.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">YES</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">YES</text></switch></g></g></svg>